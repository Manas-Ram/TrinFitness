<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teacher Dashboard</title>
    <link rel="stylesheet" href="teacherdashboard.css">
    <style>
        body {
            display: flex;
            justify-content: space-between;
            padding: 20px;
        }
        .requests {
            width: 48%;
            box-shadow: 0 0 5px rgba(0,0,0,0.1);
            margin-right: 2%;
        }
        .request {
            border-bottom: 1px solid #eee;
            padding: 10px;
        }
        .calendar {
            display: flex;
            flex-direction: column;
            width: 48%;
            box-shadow: 0 0 5px rgba(0,0,0,0.1);
            padding: 10px;
        }
        .day {
            margin-bottom: 10px;
        }
        .time-slots {
            display: flex;
            flex-direction: column;
        }
        .time-slot {
            padding: 5px;
            border-top: 1px solid #f0f0f0;
        }
    </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
          <a class="navbar-brand" href="/">
          </a>
          <ul class="navbar-nav mr-auto">
            <li class="nav-item active">
              <a class="nav-link" href="/">Home</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href='/adminstatus'> Admin Status</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" id = "calendar"href='/calendar'> Calendar</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" id = "demos"href='/demos'> Demos</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" id = "lunchplan"href='/lunchplan'> lunchplan </a>
              </li>
              <li class="nav-item">
                <a class="nav-link" id = "machine"href='/machine/bench-press'> Machine </a>
              </li>
    
              <li class="nav-item">
                <a class="nav-link" id = "menu"href='/menu'>Menu</a>
              </li>
    
              <li class="nav-item">
                <a class="nav-link" id = ""href='/teacherdashboard'> Teacher Dashboard</a>
              </li>
          </ul>
        </div>
      </nav>

      <div class="requests">
        <h2>Pending Requests</h2>
        <% slotRequests.forEach(function(request, index) { %>
            <div>
                <%= request.user %> requested for <%= request.day %> at <%= request.time %>
                <% if (request.status === 'pending') { %>
                    <button onclick="handleRequest(<%= index %>, 'accept')">Accept</button>
                    <button onclick="handleRequest(<%= index %>, 'deny')">Deny</button>
                <% } else { %>
                    Request <%= request.status %>.
                <% } %>
            </div>
        <% }); %>
    </div>

    <div class="calendar">
        <% weeklyCalendar.forEach(function(week) { %>
            <h2><%= week.name %></h2> 
            <% week.days.forEach(function(day) { %>
                <h3><%= day.name %></h3> 
                <% day.timeSlots.forEach(function(slot) { %>
                    <div><%= slot.time %>: <%= slot.status %></div> 
                <% }); %>
            <% }); %>
        <% }); %>
    </div>
    <script>
        function handleRequest(index, action) {
            fetch('/handle-request', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ requestId: index, action: action })
            }).then(response => response.json())
              .then(data => {
                  if (data.success) {
                      alert(data.message);
                      location.reload();  
                  } else {
                      alert(data.message);
                  }
              });
        }
        </script>
    

</body>
</html>
